<div class="common-table">
  <div class="number d-flex justify-content-between mb-3 align-items-center">
    <h5 class="font12 font-weight-600 mb-0">{{dataSource.length}} rows</h5>
    <div class="resend d-flex align-items-center">
      <h5 class="font12 font-weight-600 mb-0 mr-3">{{selectedRows.length}} Items selected</h5>
      <button class="btn btn-primary" [ngClass]="disabledIfZeroSelection">Resend message</button>
    </div>
  </div>
</div>
<div class="common-table">
  <div id="tbl1" class="table-responsive sticky-table sticky-ltr-cells">
    <table class="table table-borderless border-0">
      <thead class="font14 font-weight-600">
      <tr class="sticky-header">
        <th *ngFor="let header of headers; trackBy:trackByHeader" scope="col" [ngClass]="header.clazz">{{header.title}}
          <img *ngIf="isSelectableHeader(header)" src="assets/images/Checkbox-minus.svg" class="ml-0" alt="minus">
          <a *ngIf="isSortableHeader(header)"  href="javascript:void(0)" class="dropdown-toggle hide-after">
            <img src="assets/images/Double_chevron.svg" alt="chevron">
          </a>
        </th>
        <th scope="col" class="filter text-center sticky-cell-opposite table-filters-collapse"
            [ngClass]="showFilter?'active':''" (click)="showFilter=!showFilter">
          <a data-toggle="collapse" href="#filters_collapse_wrapper" class="clickable border-left">
            <img src="assets/images/Filter.svg" class="ml-0" alt="filter">
          </a>
        </th>
      </tr>
      </thead>
      <tbody>
      <tr class="collapse" id="filters_collapse_wrapper">
        <td *ngFor="let filter of filters;  let i = index; trackBy:trackByFilter" [ngClass]="filter.clazz" >
          <form *ngIf="isSearchFilter(filter)" class="form-inline search-small">
            <div class="input-group mw-180">
              <input type="text" placeholder="Search..." class="form-control border-right-0">
              <div class="input-group-append">
                <a href="javascript:void(0)" class="input-group-text bg-white px-2"><i
                  class="lni lni-search-alt"></i></a>
              </div>
            </div>
          </form>
          <div *ngIf="isSearchListFilter(filter)" class="dropdown">
            <button type="button" class="btn btn-xs btn-bordered dropdown-toggle text-left w-100 mw-180"
                    data-toggle="dropdown">
              {{selectArr.length > 0 ? selectArr.length + ' applications selected' : 'Select '}}
            </button>
            <form class="search-small dropdown-menu multi-select-dropdown mt-0">
              <div class="input-group">
                <input type="text" placeholder="Search..." class="form-control border-right-0">
                <div class="input-group-append">
                  <a href="javascript:void(0)" class="input-group-text bg-white px-2">
                    <i class="lni lni-search-alt"></i>
                  </a>
                </div>
              </div>
              <div class="dropdown-divider"></div>
              <div class="scrollable-list">
                <div class="custom-control custom-checkbox" (change)="selectedItems(-1)">
                  <input type="checkbox" class="custom-control-input" id="consumer_4" name="example1"
                         [checked]="selectAll">
                  <label class="custom-control-label" for="consumer_4">Select All</label>
                </div>
                <div class="custom-control custom-checkbox" *ngFor="let item of dataArr"
                     (click)="selectedItems(item.id)">
                  <input type="checkbox" class="custom-control-input" id="{{item.id}}" name="example1"
                         [checked]="checkedItem(item)">
                  <label class="custom-control-label" for="{{item.id}}">{{item.name}}</label>
                </div>
              </div>
            </form>
          </div>

          <form *ngIf="isTimestampFilter(filter)" class="form-inline search-small">
            <div class="d-flex align-items-center">
              <div class="mx-2">From</div>
              <app-datepicker></app-datepicker>
              <app-timepicker></app-timepicker>
            </div>
            <div class="d-flex align-items-center mt-2">
              <div class="mx-2 to">To</div>
              <app-datepicker></app-datepicker>
              <app-timepicker></app-timepicker>
            </div>
          </form>
        </td>

      </tr>
      <!-- main-table -->
      <ng-container *ngFor="let data of dataSource;let i=index; trackBy:trackByData" (scroll)="onTableScroll($event)">
        <tr class="sticky-header">
          <td *ngFor="let column of columns; trackBy:trackByColumn" [ngClass]="column.clazz">
            <a *ngIf="isMoreDataColumn(column)" href="javascript:void(0)" (click)="loadDetails(data)" data-toggle="collapse" [attr.data-target]="'#more_details'+ i"
               class="clickable">
              <img [src]="rowStatusArrow(data)" src="assets/images/Chevron.svg" alt="down">
            </a>
            <div *ngIf="isSelectableColumn(column)" class="custom-control custom-checkbox">
              <input type="checkbox" class="custom-control-input" id="check1{{i}}" (change)="itemChanged(column, data, $event)">
              <label class="custom-control-label" for="check1{{i}}"></label>
            </div>
            {{column.value(data)}}
          </td>
          <td class="dropdown text-center sticky-cell-opposite">
            <a href="#" class="dropdown-toggle hide-after" data-toggle="dropdown">
              <img src="assets/images/provider-menu.svg" alt="menu">
            </a>
            <div class="dropdown-menu dropdown-menu-right dropdown-menu-small px-2">
              <ul class="nav-vertical nav-small">
                <li class="nav-item"><a href="#" class="nav-link">Traffic</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Edit</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Deactivate</a></li>
                <li class="nav-item"><a href="#" class="nav-link">Delete</a></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr id="more_details{{i}}" class="collapse border-0" *ngIf="isMasterData(data)">

          <td colspan="30" class="position-relative">
            <app-spinner class="spinner" *ngIf="data.isLoading"></app-spinner>
            <table class="collapse-table">
              <thead>
                <tr class="border-0">
                  <th *ngFor="let header of detailHeaders; trackBy:trackByDetailHeader">{{header.title}}</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let detailData of details(data) | async;let i=index; trackBy:trackByDetailData">
                  <td *ngFor="let detailColumn of detailColumns; trackBy:trackByDetailColumn">{{detailColumn.value(detailData)}}</td>
                  <td class="text-right"><img src="assets/images/provider-menu.svg" alt="menu"></td>
                </tr>
              </tbody>
            </table>
          </td>
        </tr>
      </ng-container>
      <!-- main-collaspe-close -->
      </tbody>
    </table>
  </div>
</div>
